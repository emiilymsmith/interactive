<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/pages.css">

    <!-- D3 --->
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    
    <title>Interactive Design</title>
  </head>

  <body>
    <!-- Navigation -->
    <div id="navigation">
      <nav class="navbar navbar-expand-lg navbar-light bg-light solid w-100">
        <span class="navbar-brand mb-0 h1">EMS</span>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#sectionLink1">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sectionLink2">Background</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sectionLink3">Incidents and Response Time</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sectionLink4">Call Type</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sectionLink5">Dispatch Codes</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sectionLink6">Conclusion</a>
            </li>
          </ul>

            <!-- Month selection -->
          <ul class="navbar-nav pull-right">
            <li class="nav-item" id="form">
              <div class="float-right">
                <form id="myForm">
                  <label>First month</label>
                  <select id="selectNumber"></select>
                  <label>Last month</label>
                  <select id="selectNumber2"></select>
                </form>
              </div> <!-- end month selection-->
            </li>
          </ul>
        </div>
      </nav>
    </div> <!-- end navigation -->

    <div class="container">
      <!-- Section 1 -->
      <div class="section" id="section1">
        <!-- New Title Page --> 
        <div class="home-rootTitle" id="title">
          <h1 class="title has-text-centered">New York City</h1>
          <h2 class="subtitle has-text-centered">EMS Incident Dispatch Data</h2>
        </div> <!-- end title -->

      </div> <!-- end Section 1 -->

      <!-- Section 2 -->
      <div class="section" id="section2">
        <div class="row">
          <div class="col-6">
            <h3>The City that Never Sleeps</h3>
            <p>&emsp; Within New York City, there are over 8 million people. Manhattan is the most densely populated county in the
              United States. Every year there are thousands of incidents that require emergency medical services. In emergencies,
              seconds can make all the difference.</p><br><br>
          </div>
        </div> <!-- end row -->

        <div class="row">
          <div class="col-6"></div>
          <div class="col-6">
            <h3>FDNY</h3>
            <p>&emsp; The data was provided by the Fire Department of New York City. The FDNY EMS is responsible for the organization 
              and dispatch of all ambulances in New York City. In accordance with the Health Insurance 
              Portability and Accountability Act some of the data has been modified to protect individials privacy. The data was
              found on <a href="https://data.cityofnewyork.us/Public-Safety/EMS-Incident-Dispatch-Data/76xm-jjuj">NYC OpenData</a>.
            </p>
        </div> <!-- end row -->
      
        <div id="info">
          <h3>Dispatch Data</h3>
          <p>&emsp; The data is made up of incidents created in the EMS Computer Aided Dispatch System from 2013 to 2018. Changing the date in the 
            toolbar will adjust all of the dynamic visualizations.
          <p>&emsp; New York City is seperated into five divisions. They are: Manhattan, Brooklyn, Queens, The Bronx, and Staten Island.</p>
        </div>

      </div><!-- end of section 2-->

      <!-- Number of Incidents line chart -->
      <div id="img7">
        <div class="static-img" id="static"></div>
          <img src="images/vis7.png" />
          <div id="info">
          <p><br>&emsp;Between 2013 and 2019, the total number of incidents is always over 95 thousand. During certain times of the year the 
            density of incidents is significantly higher but considering the high number of emergencies, the communication and response by 
            emergency services is vital.
          </p></div>
      </div><!-- End of line chart -->
      
      <!-- Section 3 -->
      <div class="section" id="section3">
        <div id="info">
          <h3>Incidents and Response Time</h3>
          <p>&emsp;Within New York, the different boroughs have various numbers of incidents and levels of effeciency. Using the map, the boroughs can be 
              selected to learn more about the different groupings within the selected dates. </p>
          <p>&emsp;Only the data with a valid dispatch response time and valid incident response time are included. Even with the checks, a vulnerablilty 
            within the dataset concerning the times is highlighted. </p>
        </div>
        <div class="row">
          <!-- Select Panel / Left Column -->
          <div class="col">
            <div id="selectPanel">
            <span>Select preferred date range above.</span>
            <span>Warning: Data files are large, please be patient as they load.</span>
            <div id="spinner">
              <img id="spin" class="img-fluid" src="images/Loadingsome.gif">
            </div>
          </div>
            <img class="img-fluid" src="images/NewYorkMap.png" id="miniNY">
          </div>

          <!-- Map -->
          <div class="col-6" id="map"></div>

          <!-- Legend Panel / Right Column -->
          <div class="col" id="legendPanel">
            <div id="legendHolder">
              <span>Number of incidents reported in selected area(s):</span>
              <span id="count"></span><br>
              <span><br>Average response time (min):</span>
              <span id="avgResponseT"></span><br>
              <span><br>Min time:</span>
              <span id="minTime"></span><br>
              <span><br>Max time:</span>
              <span id="maxTime"></span>
            </div>
            
          </div>
        </div><!-- end row -->

        <div id="info">
          <h5>Response Time</h5> 
            <p>&emsp; The average response time is the time between when an incident was created in the dispatch system and when the first unit arrived on 
            location.  
          </p>
        </div> <br><br>

        <!-- Question Page --> 
        <div class="home-root" id="question">
            <h2 class="subtitle has-text-centered"><i>Given how important efficiency is, do first responders have the information to prioritize different 
              calls?</i></h2>
          </div> <!-- end question -->

        <div id="info">
        <h5>Prioritizing the Calls</h5>
        <p>&emsp;The first responders generally seem to have accurate information about the severity of the incident. With the information provided to them, 
          dispatch needs to make a call about how severe an incident is and decide what resources are available to send. The initial severity level is the 
          priority code dishpatch assigns a call when it first comes in. The final severity code is given when the incident closes. To be effecient with 
          resources, the emergency services need to be able to trust the severity is accurate. 
          </p>
        </div>

        <!-- The Severity bar charts -->
        <div id="img5-6">
            <div class="static-img" id="static"></div>
              <img src="images/vis5.png" />
          </div>
  
        <div id="img5-6">
          <div class="static-img" id="static"></div> 
            <img src="images/vis6.png" />
        </div><!-- end of severity bar charts --> 
        
        <!-- Question Page --> 
        <div class="home-root" id="question">
            <h2 class="subtitle has-text-centered"><i>Given that the initial severity is accurate, what kind of call types make up the most frequent 
              incidents?</i></h2>
        </div> <!-- end question -->

        <!-- Top Final Call Types bar chart -->
        <div id="img9">
          <div class="static-img" id="static"></div> 
            <img src="images/vis9.png" />
        </div> <!-- end bar chart -->

        <h5>The Frequency</h5>
        <p>&emsp;Over the past several years, the most frequent call type was "Sick" followed by "Injury", "Dificult Breather", and 
          "Psychiatric Patient".</p>
        <p>&emsp;Because we can see the call types that occur the most, we can see the ratio of the call types to the response 
          time per day.</p>
      
      </div><!-- end of section 3-->

      <!-- Section 4 -->
      <div class="section" id="section4">
        <div class="row">
          <div class="col-md">
            <div id="brushZoom">
              <h3>Call Type</h3>
              <div id="scatter"></div>
            </div>
          </div>
          <div class="col-md">
            <div id="scatterNarative">
              <h5>The Ratio</h5>
                <p>&emsp;In knowing the most common call types, we can see the ratio between the top call types to how much time to respond each day in the 
                    selected time range. Simply double click on the graph to reset the zoom.</p>
            </div>
            <div class="row">
              <div class="col-7">
              <table class="table table-sm" id="scatterTable">
                <thead>
                  <tr>
                    <th scope="col">Color</th>
                    <th scope="col">Code</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/lime.png" id="sIcon"></th>
                    <td>Sick</td>
                  </tr>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/purple.png" id="sIcon"></th>
                    <td>Injury</td>
                  </tr>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/blue.png" id="sIcon"></th>
                    <td>Difficulty Breathing</td>
                  </tr>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/teal.png" id="sIcon"></th>
                    <td>Psychiatric Patient</td>
                  </tr>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/red.png" id="sIcon"></th>
                    <td>Drug</td>
                  </tr>
                  <tr>
                    <th scope="row"><img src="images/scatterLegend/yellow.png"id="sIcon"></th>
                    <td>Unconscious</td>
                  </tr>
                </tbody>
              </table>
              </div>
              <div class="col-5">
            <div id="scatterDeets">
              <p>This graph is representing the number of incidents by response time in seconds. 
                Each day is represented by a single dot.</p>
            </div>
              </div>
          </div>
          </div>
        </div>
      </div><!-- end section 4 -->

      <!-- Question Page --> 
      <div class="home-root" id="question">
          <h2 class="subtitle has-text-centered"><i>For the different dispatch codes, what are the phases of the response time?</i></h2>
      </div> <!-- end question -->

      <!-- Section 5 -->
      <div class="section" id="section5">
       <div id="codes">
        <h3>Dispatch Codes</h3>
        <p>&emsp;Here is the breakdown between the travel time and the dispatch response time. The dispatch response time is the time between when
          the incident was created in the dispatch system and when a unit is assigned to that incident. The travel time is the time between when the 
          unit is assigned and when they arrive at the site of the incident. The moment when an incident is first created to when emergency services arrive
          is the incident response time. The incident disposition code reports what the outcome of the incident was.</p>
        <p>&emsp;The histogram shows the dispatch code and the average response time in seconds for each code. The pie chart breaks 
          down the dispatch response time and the travel time.</p>
        <div class="row" id="piebar"></div>
          <div class="table"><!-- Table -->
            <table> 
              <tr>
                <td>82</td> 
                <td>Transporting Patient</td>
                <td>&emsp;</td>
                <td>&emsp;</td>
                <td>92</td> 
                <td>Treated Not Transported</td>
              </tr>
              <tr>
                <td>83</td> 
                <td>Patient Pronounced Dead</td>
                <td>&emsp;</td>
                <td>&emsp;</td>
                <td>93</td> 
                <td>Refused Medical Aid</td>
              </tr>
              <tr>
                <td>87</td> 
                <td>Cancelled</td>
                <td>&emsp;</td>
                <td>&emsp;</td>
                <td>94</td> 
                <td>Treated and Transported</td>
              </tr>
              <tr>
                <td>90</td> 
                <td>Unfounded</td>
                <td>&emsp;</td>
                <td>&emsp;</td>
                <td>95</td> 
                <td>Triaged at Scene No Transport</td>
              </tr>
              <tr>
                <td>91</td>
                <td>Condition Corrected</td>
                <td>&emsp;</td>
                <td>&emsp;</td>
                <td>96</td>
                <td>Patient Gone on Arrival</td>
              </tr>
            </table>
          </div> <!-- end table -->
       </div>

       <div class="info">
          <br><h5>Travel Time</h5>
          <p>&emsp;Considering the histogram and pie chart, we can see that there is a difference between how the response time
            is broken down into dispatch time and the travel time. The travel time generally takes significantly longer than the 
            time it takes dispatch to assign a unit. 
          </p>
        </div>

       <!-- The weird bubble static vis --> 
       <div id="img10">
        <div class="static-img" id="static"></div>
        <img src="images/vis10.png" />
       </div>

       <div id="info">
        <br><h5>Dispatch Time</h5>
        <p>&emsp;Observing the dispatch time directly, the differences within New York City can be analyzed. Considering the average 
          dispatch time in seconds for each borough, Staten Island has the quickest dispatch time.
        </p>
       </div>

       <!-- Dispatch Response by Borough the boxes one -->
       <div id="img4">
        <div class="static-img" id="static"></div> 
          <img src="images/vis4.png" />
       </div><!-- end image -->

      </div> <!-- end section 5 -->

      <!-- Conclusion -->
       <div class="section" id="section6">
        <div id="conclusion">
          <h3>Conclusion</h3>
          <p>&emsp;Effeciency is vital when it comes to EMS. Minutes and seconds can make all the difference. We can explore how effecient 
            the different are boroughs in terms of response time, how the effeciency 
            changes with frequency, and we can explore how the different disposition codes interact with the effeciency. </p>
          <p>&emsp; As a group, we decided to use a map, a histogram, and a scatter plot for our interactive visualizations. We had 
            considered a few other options, but based 
            on the dataset that we have we felt a map, histogram, and scatter plot were the best way to convey our data. The tooltip is 
            the guide to the map and shows the boroughs. The 
            dropdown lists the range of dates chronologically. We wanted to be able to zoom in on the scatter plot to give further detail in addition to the bigger picture.
            Breaking down the dispatch codes allowed us to explore another side of the data.  
            As a group, we chose a minimalist approach in order to keep our visualizations from becoming too overwhelming.</p>
            <p>&emsp;The first step in the development process was displaying a simple static map. 
            We began by having the state of New York drawn before narrowing the map down to the specific areas we wanted to examine. 
            Then we chose to add 
            specific features such as dropdowns for the desired range of months and to display the data. After that it was just a matter 
            of adding 
            more static and interactive visualizations. Collaboration was vital in the 
            later stages of development to bring all of the pieces together.</p>
            <p>&emsp;Many hours were spent developing the application. The aspects that took the most time were breaking up the csv file 
              and adjusting the latter interactive
              visualizations to fit our dataset. 
            Since the data file is large, we had to divide the csv into multiple files in order to access the data. Using the csv with our data was a 
            relatively new process for the group. It was a steep learning curve figuring out how the parts worked together to create multiple dynamic visualization.  
          </p>
          <br><h6>Created by: Stanton Carlisle, Hannah Dolan, Nathan Raymond, Emily Smith</h6>
        </div> <!-- Conclusion -->
      </div> <!-- end section 6 -->

    </div> <!-- end container -->

    <script>
      var select = document.getElementById("selectNumber"); 
      var select2 = document.getElementById("selectNumber2"); 
      var filesList = ["1_2013-01-01.csv","2_2013-02-01.csv","3_2013-03-01.csv","4_2013-04-01.csv","5_2013-05-01.csv","6_2013-06-01.csv","7_2013-07-01.csv","8_2013-08-01.csv","9_2013-09-01.csv","10_2013-10-01.csv","11_2013-11-01.csv","12_2013-12-01.csv","13_2014-01-01.csv","14_2014-02-01.csv","15_2014-03-01.csv","16_2014-04-01.csv","17_2014-05-01.csv","18_2014-06-01.csv","19_2014-07-01.csv","20_2014-08-01.csv","21_2014-09-01.csv","22_2014-10-01.csv","23_2014-11-01.csv","24_2014-12-01.csv","25_2015-01-01.csv","26_2015-02-01.csv","27_2015-03-01.csv","28_2015-04-01.csv","29_2015-05-01.csv","30_2015-06-01.csv","31_2015-07-01.csv","32_2015-08-01.csv","33_2015-09-01.csv","34_2015-10-01.csv","35_2015-11-01.csv","36_2015-12-01.csv","37_2016-01-01.csv","38_2016-02-01.csv","39_2016-03-01.csv","40_2016-04-01.csv","41_2016-05-01.csv","42_2016-06-01.csv","43_2016-07-01.csv","44_2016-08-01.csv","45_2016-09-01.csv","46_2016-10-01.csv","47_2016-11-01.csv","48_2016-12-01.csv","49_2017-01-01.csv","50_2017-02-01.csv","51_2017-03-01.csv","52_2017-04-01.csv","53_2017-05-01.csv","54_2017-06-01.csv","55_2017-07-01.csv","56_2017-08-01.csv","57_2017-09-01.csv","58_2017-10-01.csv","59_2017-11-01.csv","60_2017-12-01.csv","61_2018-01-01.csv","62_2018-02-01.csv","63_2018-03-01.csv","64_2018-04-01.csv","65_2018-05-01.csv","66_2018-06-01.csv","67_2018-07-01.csv","68_2018-08-01.csv","69_2018-09-01.csv","70_2018-10-01.csv","71_2018-11-01.csv","72_2018-12-01.csv"];

      for(var i = 0; i < filesList.length; i++) {
          var opt = filesList[i];
          var el = document.createElement("option");
          var al = document.createElement("option");
          var string = opt.split("_")[1];
          string = string.split("-")[0] + "-" + string.split("-")[1];
          el.textContent = string;
          el.value = opt;
          al.textContent = string;
          al.value = opt;
          select.appendChild(el);
          select2.appendChild(al);
          
      }
      </script>

    <!-- bootstrap -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <!-- local javascript -->
    <script src="scripts/datum.js" type="text/javascript"></script> 
    <script src="scripts/navigation.js" type="text/javascript"></script> 
    <script src="scripts/ny.js" type="text/javascript"></script>
    <script src="scripts/scatter.js" type="text/javascript"></script>
    <script src="scripts/piebar.js" type="text/javascript"></script>
    

  </body>
</html>